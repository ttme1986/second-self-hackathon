<mxfile host="app.diagrams.net" modified="2026-02-10" agent="Second-Self" version="24.0.0">
  <diagram id="second-self-infra" name="System Infrastructure">
    <mxGraphModel dx="1600" dy="1000" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1200" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- ===== TITLE ===== -->
        <mxCell id="title" value="Second-Self System Infrastructure" style="text;html=1;fontSize=24;fontStyle=1;align=center;verticalAlign=middle;fillColor=none;strokeColor=none;fontColor=#1e293b;" vertex="1" parent="1">
          <mxGeometry x="400" y="10" width="800" height="40" as="geometry" />
        </mxCell>
        <mxCell id="subtitle" value="Autonomous Life Operating System — Gemini 3 Hackathon" style="text;html=1;fontSize=12;align=center;verticalAlign=middle;fillColor=none;strokeColor=none;fontColor=#64748b;" vertex="1" parent="1">
          <mxGeometry x="400" y="45" width="800" height="20" as="geometry" />
        </mxCell>

        <!-- ===== USER / BROWSER ===== -->
        <mxCell id="browser-group" value="Browser (Client-Side — Zero Backend Server)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=14;fontStyle=1;verticalAlign=top;spacingTop=5;arcSize=8;" vertex="1" parent="1">
          <mxGeometry x="80" y="80" width="1440" height="710" as="geometry" />
        </mxCell>

        <!-- UI Layer -->
        <mxCell id="ui-group" value="UI Layer (React 19 + Vite + TypeScript)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8d5f5;strokeColor=#9673a6;fontSize=12;fontStyle=1;verticalAlign=top;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="120" y="120" width="700" height="120" as="geometry" />
        </mxCell>
        <mxCell id="login" value="Login" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#6366f1;fontColor=#fff;strokeColor=#4f46e5;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="140" y="160" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hub" value="Hub" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#6366f1;fontColor=#fff;strokeColor=#4f46e5;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="260" y="160" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="chat" value="Chat" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#6366f1;fontColor=#fff;strokeColor=#4f46e5;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="380" y="160" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="reflect" value="Reflect" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#6366f1;fontColor=#fff;strokeColor=#4f46e5;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="500" y="160" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="settings" value="Settings" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#6366f1;fontColor=#fff;strokeColor=#4f46e5;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="620" y="160" width="100" height="50" as="geometry" />
        </mxCell>

        <!-- Hooks Layer -->
        <mxCell id="hooks-group" value="React Hooks" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f3e8ff;strokeColor=#a78bfa;fontSize=12;fontStyle=1;verticalAlign=top;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="120" y="270" width="700" height="100" as="geometry" />
        </mxCell>
        <mxCell id="useVoice" value="useVoice&#xa;Session" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#8b5cf6;fontColor=#fff;strokeColor=#7c3aed;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="130" y="305" width="100" height="45" as="geometry" />
        </mxCell>
        <mxCell id="useTranscript" value="useTranscript" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#8b5cf6;fontColor=#fff;strokeColor=#7c3aed;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="240" y="305" width="100" height="45" as="geometry" />
        </mxCell>
        <mxCell id="usePipeline" value="useBlackboard&#xa;Pipeline" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#8b5cf6;fontColor=#fff;strokeColor=#7c3aed;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="350" y="305" width="100" height="45" as="geometry" />
        </mxCell>
        <mxCell id="useSuggested" value="useSuggested&#xa;Actions" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#8b5cf6;fontColor=#fff;strokeColor=#7c3aed;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="460" y="305" width="100" height="45" as="geometry" />
        </mxCell>
        <mxCell id="useEmotional" value="useEmotional&#xa;Tracking" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#8b5cf6;fontColor=#fff;strokeColor=#7c3aed;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="570" y="305" width="100" height="45" as="geometry" />
        </mxCell>
        <mxCell id="useAttach" value="useAttachments" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#8b5cf6;fontColor=#fff;strokeColor=#7c3aed;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="680" y="305" width="100" height="45" as="geometry" />
        </mxCell>

        <!-- Agent Pipeline -->
        <mxCell id="agent-group" value="Agent Pipeline (Blackboard Pattern)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fce7f3;strokeColor=#db2777;fontSize=12;fontStyle=1;verticalAlign=top;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="120" y="400" width="700" height="100" as="geometry" />
        </mxCell>
        <mxCell id="blackboard" value="Blackboard&#xa;(Task Queue&#xa;+ Event Bus)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ec4899;fontColor=#fff;strokeColor=#db2777;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="140" y="430" width="120" height="55" as="geometry" />
        </mxCell>
        <mxCell id="analyzer" value="AnalyzerAgent&#xa;extractClaimsAndActions()&#xa;thought signatures + dedup" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ec4899;fontColor=#fff;strokeColor=#db2777;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="290" y="430" width="150" height="55" as="geometry" />
        </mxCell>
        <mxCell id="validator" value="ValidatorAgent&#xa;embedText() + cosineSim&#xa;detectConflict()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ec4899;fontColor=#fff;strokeColor=#db2777;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="470" y="430" width="150" height="55" as="geometry" />
        </mxCell>
        <mxCell id="publisher" value="ActionPublish&#xa;Agent&#xa;Surface to UI" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ec4899;fontColor=#fff;strokeColor=#db2777;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="650" y="430" width="120" height="55" as="geometry" />
        </mxCell>

        <!-- Services -->
        <mxCell id="svc-group" value="Services" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ccfbf1;strokeColor=#0d9488;fontSize=12;fontStyle=1;verticalAlign=top;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="860" y="120" width="620" height="280" as="geometry" />
        </mxCell>
        <mxCell id="liveAudio" value="liveAudioService&#xa;(WebSocket + Chat API)&#xa;Voice: Kore | 16kHz/24kHz" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#14b8a6;fontColor=#fff;strokeColor=#0d9488;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="880" y="155" width="160" height="55" as="geometry" />
        </mxCell>
        <mxCell id="memCtx" value="memoryContext&#xa;(System Prompt Builder)&#xa;Claims+Goals+Actions+Memory" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#14b8a6;fontColor=#fff;strokeColor=#0d9488;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="1060" y="155" width="160" height="55" as="geometry" />
        </mxCell>
        <mxCell id="focusGen" value="focusGenerator&#xa;(Daily Focus + Insights)&#xa;code execution tool" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#14b8a6;fontColor=#fff;strokeColor=#0d9488;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="1240" y="155" width="160" height="55" as="geometry" />
        </mxCell>
        <mxCell id="actionExec" value="actionExecutor&#xa;(Draft + Execute)&#xa;Search + URL Context tools" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#14b8a6;fontColor=#fff;strokeColor=#0d9488;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="880" y="235" width="160" height="55" as="geometry" />
        </mxCell>
        <mxCell id="emotionTrack" value="emotionTracker&#xa;(Trends + Wellness)&#xa;Longitudinal Analysis" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#14b8a6;fontColor=#fff;strokeColor=#0d9488;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="1060" y="235" width="160" height="55" as="geometry" />
        </mxCell>
        <mxCell id="storageUp" value="storageUpload&#xa;(Transcripts + Photos)&#xa;Firebase Cloud Storage" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#14b8a6;fontColor=#fff;strokeColor=#0d9488;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="1240" y="235" width="160" height="55" as="geometry" />
        </mxCell>
        <mxCell id="convRealtime" value="conversationRealtime&#xa;(InferredClaim type)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#14b8a6;fontColor=#fff;strokeColor=#0d9488;fontSize=9;" vertex="1" parent="1">
          <mxGeometry x="880" y="315" width="160" height="40" as="geometry" />
        </mxCell>

        <!-- Context Providers -->
        <mxCell id="prov-group" value="Context Providers" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e2e8f0;strokeColor=#64748b;fontSize=11;fontStyle=1;verticalAlign=top;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="1060" y="400" width="360" height="100" as="geometry" />
        </mxCell>
        <mxCell id="authProv" value="AuthProvider&#xa;(Google OAuth)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#64748b;fontColor=#fff;strokeColor=#475569;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1080" y="430" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="profileProv" value="ProfileProvider&#xa;(React Context)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#64748b;fontColor=#fff;strokeColor=#475569;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1200" y="430" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="olProv" value="OpenLoops&#xa;Provider" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#64748b;fontColor=#fff;strokeColor=#475569;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1320" y="430" width="80" height="50" as="geometry" />
        </mxCell>

        <!-- Data Layer -->
        <mxCell id="data-group" value="Data Layer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fef3c7;strokeColor=#d97706;fontSize=12;fontStyle=1;verticalAlign=top;spacingTop=5;" vertex="1" parent="1">
          <mxGeometry x="120" y="530" width="1360" height="110" as="geometry" />
        </mxCell>
        <mxCell id="backend" value="backend.ts&#xa;(API Facade ~1750 LOC)&#xa;15+ Gemini integration points" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f59e0b;fontColor=#fff;strokeColor=#d97706;fontSize=10;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="140" y="565" width="220" height="55" as="geometry" />
        </mxCell>
        <mxCell id="localStore" value="localStore.ts&#xa;(localStorage)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f59e0b;fontColor=#fff;strokeColor=#d97706;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="390" y="565" width="140" height="55" as="geometry" />
        </mxCell>
        <mxCell id="fsStore" value="firestoreStore.ts" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f59e0b;fontColor=#fff;strokeColor=#d97706;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="560" y="565" width="140" height="55" as="geometry" />
        </mxCell>
        <mxCell id="fsSync" value="firestoreSync.ts" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f59e0b;fontColor=#fff;strokeColor=#d97706;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="730" y="565" width="140" height="55" as="geometry" />
        </mxCell>
        <mxCell id="writeGate" value="firestoreWriteGate&#xa;(Deferred Writes)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f59e0b;fontColor=#fff;strokeColor=#d97706;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="900" y="565" width="140" height="55" as="geometry" />
        </mxCell>
        <mxCell id="firebaseLib" value="firebase.ts&#xa;(SDK Init)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f59e0b;fontColor=#fff;strokeColor=#d97706;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1070" y="565" width="120" height="55" as="geometry" />
        </mxCell>
        <mxCell id="analytics" value="analytics.ts" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f59e0b;fontColor=#fff;strokeColor=#d97706;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1220" y="565" width="100" height="55" as="geometry" />
        </mxCell>
        <mxCell id="evidence" value="evidence.ts" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f59e0b;fontColor=#fff;strokeColor=#d97706;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1350" y="565" width="100" height="55" as="geometry" />
        </mxCell>

        <!-- ===== EXTERNAL: GEMINI ===== -->
        <mxCell id="gemini-group" value="Google Gemini API (3 Models, 15+ Integration Points)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f0fe;strokeColor=#4285f4;fontSize=14;fontStyle=1;verticalAlign=top;spacingTop=5;strokeWidth=3;" vertex="1" parent="1">
          <mxGeometry x="80" y="840" width="760" height="160" as="geometry" />
        </mxCell>
        <mxCell id="geminiLive" value="gemini-2.5-flash&#xa;-native-audio-preview-12-2025&#xa;(Live WebSocket bidiGenerateContent)&#xa;Voice: Kore | Transcription | VAD" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#4285f4;fontColor=#fff;strokeColor=#1a73e8;fontSize=10;fontStyle=1;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="100" y="875" width="210" height="100" as="geometry" />
        </mxCell>
        <mxCell id="geminiFlash" value="gemini-3-flash-preview&#xa;(REST generateContent)&#xa;Thinking LOW/MED/HIGH | JSON Output&#xa;Code Exec | Search | URL Context&#xa;Thought Signatures | Media Resolution" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#4285f4;fontColor=#fff;strokeColor=#1a73e8;fontSize=10;fontStyle=1;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="340" y="875" width="230" height="100" as="geometry" />
        </mxCell>
        <mxCell id="geminiEmbed" value="gemini-embedding-001&#xa;(REST embedContent)&#xa;768-dim vectors&#xa;Semantic Search &amp; Deduplication" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#4285f4;fontColor=#fff;strokeColor=#1a73e8;fontSize=10;fontStyle=1;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="600" y="875" width="210" height="100" as="geometry" />
        </mxCell>

        <!-- ===== EXTERNAL: FIREBASE ===== -->
        <mxCell id="firebase-group" value="Firebase (Google Cloud)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#ff9100;fontSize=14;fontStyle=1;verticalAlign=top;spacingTop=5;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="900" y="840" width="580" height="160" as="geometry" />
        </mxCell>
        <mxCell id="fbAuth" value="Firebase Auth&#xa;(Google Sign-In)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ff9100;fontColor=#fff;strokeColor=#e65100;fontSize=11;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="920" y="885" width="150" height="70" as="geometry" />
        </mxCell>
        <mxCell id="fbFirestore" value="Cloud Firestore&#xa;users/{uid}/*&#xa;(Deferred writeBatch)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ff9100;fontColor=#fff;strokeColor=#e65100;fontSize=10;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1100" y="885" width="150" height="70" as="geometry" />
        </mxCell>
        <mxCell id="fbStorage" value="Firebase Storage&#xa;users/{uid}/conversations/&#xa;transcript.json + media" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ff9100;fontColor=#fff;strokeColor=#e65100;fontSize=10;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="1280" y="885" width="170" height="70" as="geometry" />
        </mxCell>

        <!-- ===== CONNECTIONS ===== -->

        <!-- UI -> Hooks -->
        <mxCell id="e1" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#94a3b8;" edge="1" source="chat" target="useVoice" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e2" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#94a3b8;" edge="1" source="chat" target="useTranscript" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e3" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#94a3b8;" edge="1" source="chat" target="usePipeline" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e4" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#94a3b8;" edge="1" source="chat" target="useSuggested" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e4b" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#94a3b8;" edge="1" source="chat" target="useEmotional" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e4c" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#94a3b8;" edge="1" source="chat" target="useAttach" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>

        <!-- Hooks -> Services -->
        <mxCell id="e5" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#94a3b8;" edge="1" source="useVoice" target="liveAudio" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e6" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#94a3b8;" edge="1" source="useVoice" target="memCtx" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>

        <!-- Hooks -> Agents -->
        <mxCell id="e7" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#94a3b8;" edge="1" source="useTranscript" target="blackboard" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e8" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#94a3b8;" edge="1" source="useSuggested" target="actionExec" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>

        <!-- Agent pipeline flow -->
        <mxCell id="e9" value="turn.ingest" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#db2777;fontColor=#db2777;fontSize=9;" edge="1" source="blackboard" target="analyzer" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e10" value="proposed" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#db2777;fontColor=#db2777;fontSize=9;" edge="1" source="analyzer" target="validator" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e11" value="validated" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#db2777;fontColor=#db2777;fontSize=9;" edge="1" source="validator" target="publisher" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>

        <!-- Agents -> Backend -->
        <mxCell id="e12" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d97706;" edge="1" source="analyzer" target="backend" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e13" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d97706;" edge="1" source="validator" target="backend" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e14" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d97706;" edge="1" source="publisher" target="backend" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>

        <!-- Services -> Backend -->
        <mxCell id="e15" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d97706;" edge="1" source="memCtx" target="backend" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e16" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d97706;" edge="1" source="focusGen" target="backend" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e17" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d97706;" edge="1" source="actionExec" target="backend" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e17b" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d97706;" edge="1" source="emotionTrack" target="backend" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>

        <!-- Data layer internal -->
        <mxCell id="e18" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d97706;" edge="1" source="backend" target="localStore" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e19" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d97706;" edge="1" source="backend" target="fsStore" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e20" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d97706;" edge="1" source="fsStore" target="writeGate" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e21" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#d97706;" edge="1" source="fsStore" target="firebaseLib" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>

        <!-- ===== GEMINI CONNECTIONS (thick blue) ===== -->
        <mxCell id="g1" value="bidiGenerateContent&#xa;(real-time audio + transcription)" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#4285f4;strokeWidth=3;fontColor=#4285f4;fontSize=9;fontStyle=1;" edge="1" source="liveAudio" target="geminiLive" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="g2" value="ai.chats.create + sendMessageStream&#xa;(text-only fallback)" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#4285f4;strokeWidth=3;fontColor=#4285f4;fontSize=9;fontStyle=1;" edge="1" source="liveAudio" target="geminiFlash" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="g3" value="extractClaimsAndActions (thinking LOW)&#xa;detectConflict (thinking HIGH)&#xa;detectEmotion (JSON schema)&#xa;summarizeTranscript, consolidateMemory&#xa;analyzeImage (code exec), goalMilestones&#xa;checkInResponse (thinking MED)" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#4285f4;strokeWidth=3;fontColor=#4285f4;fontSize=8;fontStyle=1;" edge="1" source="backend" target="geminiFlash" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="g4" value="embedText, embedQuery&#xa;(768-dim vectors)" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#4285f4;strokeWidth=3;fontColor=#4285f4;fontSize=9;fontStyle=1;" edge="1" source="backend" target="geminiEmbed" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="g5" value="generateActionDraft&#xa;(Search + URL Context tools)" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#4285f4;strokeWidth=3;fontColor=#4285f4;fontSize=9;fontStyle=1;" edge="1" source="actionExec" target="geminiFlash" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="g6" value="todaysFocus, computeInsights&#xa;(code execution tool)" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#4285f4;strokeWidth=3;fontColor=#4285f4;fontSize=9;fontStyle=1;" edge="1" source="focusGen" target="geminiFlash" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>

        <!-- ===== FIREBASE CONNECTIONS ===== -->
        <mxCell id="f1" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#ff9100;strokeWidth=2;" edge="1" source="authProv" target="fbAuth" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="f2" value="setDoc / writeBatch" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#ff9100;strokeWidth=2;fontColor=#e65100;fontSize=9;" edge="1" source="fsStore" target="fbFirestore" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="f3" value="getDocs (sync)" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#ff9100;strokeWidth=2;fontColor=#e65100;fontSize=9;" edge="1" source="fsSync" target="fbFirestore" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="f4" value="uploadBytes" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#ff9100;strokeWidth=2;fontColor=#e65100;fontSize=9;" edge="1" source="storageUp" target="fbStorage" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="f5" value="commitSessionToFirestore&#xa;(writeBatch)" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#ff9100;strokeWidth=2;fontColor=#e65100;fontSize=9;" edge="1" source="backend" target="fbFirestore" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>

        <!-- Login -> Auth -->
        <mxCell id="e22" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#94a3b8;" edge="1" source="login" target="authProv" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>

        <!-- Hub -> Services -->
        <mxCell id="e23" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#94a3b8;" edge="1" source="hub" target="focusGen" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e24" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#94a3b8;" edge="1" source="hub" target="emotionTrack" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>

        <!-- Provider -> Backend -->
        <mxCell id="e25" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#94a3b8;" edge="1" source="profileProv" target="backend" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>
        <mxCell id="e26" style="edgeStyle=orthogonalEdgeStyle;rounded=1;strokeColor=#94a3b8;" edge="1" source="authProv" target="backend" parent="1"><mxGeometry relative="1" as="geometry" /></mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
